# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your
# code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml
---
pr:
  branches:
    exclude:
      - gh-pages
    include:
      - '*'

trigger:
  branches:
    exclude:
      - gh-pages
    include:
      - master

pool:
  vmImage: 'ubuntu-latest'

steps:
  - script: npm install
    displayName: 'Install dependencies'
  - script: npm run ci
    displayName: 'Lint and test'
  - script: npm run publish:styleguide
    displayName: 'Publish styleguide to gh-pages'
    env:
      GIT_SOURCE_BRANCH: $(Build.SourceBranch)
      GITHUB_APP_ID: $(GITHUB_APP_ID)
      GITHUB_APP_PRIVATE_KEY: $(GITHUB_APP_PRIVATE_KEY)
